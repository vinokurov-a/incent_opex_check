
# 99-incent.opex.slack_notify

–û—Ç–ø—Ä–∞–≤–∫–∞ Slack-–Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–π –æ–± –∞–ª–µ—Ä—Ç–∞—Ö.

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∞–ª–µ—Ä—Ç—ã –∏–∑ `ma_data.incent_opex_check_universal` –∑–∞ —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ Slack. –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–æ–∫ —á–µ—Ä–µ–∑ `00-incent.opex.check_main.ipynb`.

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ Google Sheets
2. –ß–∏—Ç–∞–µ—Ç –∞–ª–µ—Ä—Ç—ã –∑–∞ —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å –∏–∑ `ma_data.incent_opex_check_universal` (`is_alert = TRUE`)
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ `check_name`:
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç `notification_flag == 'Enabled'`
   - –í—ã–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç–ø—Ä–∞–≤–∫–∏
4. –í—ã–≤–æ–¥–∏—Ç —Å—Ç–∞—Ç—É—Å –æ—Ç–ø—Ä–∞–≤–∫–∏

## SQL-–∑–∞–ø—Ä–æ—Å

```sql
SELECT *
FROM ma_data.incent_opex_check_universal
WHERE date::DATE = '{today}'
  AND is_alert = TRUE
ORDER BY check_name, app_short, country, segment
```

## –§–æ—Ä–º–∞—Ç –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–π

### 01-incent.cr (Conversion Rate)

**–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞:** –ø–æ `app_short`

**–û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–≤ –∫–∞–Ω–∞–ª):**
```
INCENT.OpEx - 01-incent.cr (INFO): *SOLITAIRE (ios)*:
 üî∫ Lvl 1 (cw 7) | CR: 12.34% | Prev (+5.2%)
 üîª Lvl 2 (cw 30) | CR: 8.45% | Hist (-4.8%)
```

**Thread:** –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∞–º (–µ—Å–ª–∏ `check_countries = true`)

### 02-incent.p7 (Payers)

**–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞:** –ø–æ `partner_id`

**–û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–≤ –∫–∞–Ω–∞–ª):**
```
INCENT.OpEx - 02-incent.p7 (INFO): üî¥ *AdJoe*
```

**Thread (–¥–µ—Ç–∞–ª–∏ –ø–æ app –∏ —Å–µ–≥–º–µ–Ω—Ç–∞–º):**
```
üî¥ [CRITICAL] SOLITAIRE / Segment_A: 15 payers (4 –Ω–µ–¥., threshold: 50)
üü° [WARNING] SOLITAIRE / Segment_B: 8 payers (1 –Ω–µ–¥., threshold: 10)
```

### 03-incent.cpb / 04-incent.c2p / 05-incent.ret (–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏)

**–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞:** –ø–æ `partner_id`

–¢—Ä–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–π:
- **03-incent.cpb** ‚Üí CPB (cpb3, cpb7)
- **04-incent.c2p** ‚Üí C2P (c2p3, c2p7)
- **05-incent.ret** ‚Üí Retention (ret3, ret7)

**–û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–≤ –∫–∞–Ω–∞–ª):**
```
INCENT.OpEx - 03-incent.cpb (INFO), CPB: üî¥ *AdJoe*
```

**Thread (–¥–µ—Ç–∞–ª–∏ –ø–æ app, country, segment):**
```
üî∫ FD | ALL | Segment_US | cpb3: $12.50 (+15.2%)
üîª FD | US | Segment_US | cpb7: $14.30 (-8.1%)
```

## –ò–∫–æ–Ω–∫–∏

| –¢–∏–ø | –ò–∫–æ–Ω–∫–∞ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|-----|--------|---------------|
| –ú–µ—Ç—Ä–∏–∫–∞ –≤–≤–µ—Ä—Ö | üî∫ `:green_triangle_up_alert:` | –†–æ—Å—Ç –º–µ—Ç—Ä–∏–∫–∏ |
| –ú–µ—Ç—Ä–∏–∫–∞ –≤–Ω–∏–∑ | üîª `:red_triangle_down_alert:` | –ü–∞–¥–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ |
| CRITICAL | üî¥ `:red_circle:` | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∞–ª–µ—Ä—Ç / –∑–∞–≥–æ–ª–æ–≤–æ–∫ metrics |
| WARNING | üü° `:large_yellow_circle:` | –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ payers |

## –ü–æ–ª–µ `notification_flag`

- `Enabled` ‚Äî –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∞–∫—Ç–∏–≤–Ω—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- –õ—é–±–æ–µ –¥—Ä—É–≥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äî –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫

–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–π –¥–ª—è –Ω–æ–≤–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `send_<check>_notifications(alerts_df, config_row)` –≤ –Ω–æ—É—Ç–±—É–∫–µ
2. –î–æ–±–∞–≤—å—Ç–µ –≤—ã–∑–æ–≤ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª:
```python
elif check_name == '06-incent.ltv':
    send_ltv_notifications(check_alerts, config_row)
```